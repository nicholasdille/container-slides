<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>

<title>OCI 1.1</title>

<!-- https://gauger.io/fonticon/ -->
<link rel="icon" href="images/kubernetes.ico"/>

<link rel="stylesheet" href="media/reveal.js@4.6.0/dist/reveal.css"/>
<link rel="stylesheet" href="media/source-sans@3.052/font.css"/>
<link rel="stylesheet" href="media/reveal.js@4.6.0/dist/theme/black.css" id="theme"/>
<link rel="stylesheet" href="themes/theme2022.css" id="theme"/>
<link rel="stylesheet" href="themes/common.css"/>
<link rel="stylesheet" href="media/highlight.js@11.8.0/styles/rainbow.css"/>

<script>
    var version = '6.4.2'
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    if (window.location.href.match(/^http(s)?:\/\/(.+\.)*dille.name/)) {
        link.href = 'https://cdn.dille.name/fontawesome-pro@' + version + '/css/all.min.css';
    } else {
        link.href = 'media/fontawesome-pro@' + version + '/css/all.min.css';
    }
    document.head.appendChild(link);
</script>
</head>

<body>
<div class="reveal">
<div class="slides">

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
<!-- .slide: data-background="images/diego-ph-fIq0tET6llw-unsplash.jpg" class="vertical-center" style="padding: 1em 1em 1em 1em; color: white; background: rgba(0, 0, 0, 0.5); width: 90%; margin: auto;" -->

# OCI Registries as Generic Artifact Stores<br/>What OCI 1.1 brings

*Nicholas Dille, Haufe Group*

<i class="fa-brands fa-docker" style="width: 1.5em; text-align: center;"></i> Docker Captain

<i class="fa-brands fa-x-twitter" style="width: 1.5em; text-align: center;"></i> [@nicholasdille](https://twitter.com/nicholasdille)

<i class="fa-brands fa-mastodon" style="width: 1.5em; text-align: center;"></i> [@nicholasdille@freiburg.social](https://freiburg.social/@nicholasdille)
</textarea></section>

<section data-markdown="000_introduction/02_bio.md" data-separator="^---$" data-separator-vertical="^--$"></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
<!-- 110_ecosystem/oci/slides.md -->
## What this is about

We build <i class="fa-duotone fa-user-helmet-safety"></i> container images <i class="fa-duotone fa-database"></i> and...

...push <i class="fa-duotone fa-person-dolly"></i> them into a registry <i class="fa-duotone fa-warehouse-full"></i>

Registries are self-hosted <i class="fa-duotone fa-server"></i> or...

...consumed as-a-Service <i class="fa-duotone fa-square-phone"></i>

All of them follow a flexible spec <i class="fa-duotone fa-file-certificate"></i>

They can store generic artifacts <i class="fa-duotone fa-box-open-full"></i>
</textarea></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
<!-- 110_ecosystem/oci/slides.md -->
## Open Container Initiative

OCI [](https://opencontainers.org/)

Specifications:

- Runtime [](https://github.com/opencontainers/runtime-spec)
- Image [](https://github.com/opencontainers/image-spec)
- Distribution [](https://github.com/opencontainers/distribution-spec)

runc [](https://github.com/opencontainers/runc) - reference implementation of runtime spec

Founded in 2015 by leaders in the container industry

Version 1.0 was release in 2020

Currently 29 members

Technical oversight commitee from 8 companies
</textarea></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
## Scope of this talk

XXX

### How does an OCI registry work

XXX v1.0

### What does the future hold

XXX v1.1
</textarea></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
<!-- 110_ecosystem/oci/slides.md -->
## How registries work

Typical workflow interacting with a container registry

![](110_ecosystem/oci/container_image_registry.drawio.svg) <!-- .element: style="width: 60%; margin-top: 1em;" -->

---

## How registries work internally

![](110_ecosystem/oci/oci_registry.drawio.svg) <!-- .element: style="width: 100%; margin-top: 1em;" -->

---

## Media types

OCI defines new media types

Widespread adoption of OCI media types

| What           | OCI                             | Docker                                        |
|----------------|---------------------------------|-----------------------------------------------|
| Image Index    | vnd.oci.image.index.v1+json     | vnd.docker.distribution.manifest.list.v2+json |
| Image Manifest | vnd.oci.image.manifest.v1+json  | vnd.docker.distribution.manifest.v2+json      |
| Image Config   | vnd.oci.image.config.v1+json    | vnd.docker.container.image.v1+json            |
| Image Layer    | vnd.oci.image.layer.v1.tar+gzip | vnd.docker.image.rootfs.diff.tar.gzip         |

<!-- .element: style="width: 105%; font-size: xx-large;" -->

---

## Accept header

XXX

### Single Accept header

XXX

XXX demo

### Multiple Accept headers

XXX multiple media types

XXX demo
</textarea></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
<!-- 110_ecosystem/oci/slides.md -->
## How it started

What if we used new media types?!

### <span style="font-size: larger;">O</span>CI <span style="font-size: larger;">R</span>egistries <span style="font-size: larger;">a</span>s <span style="font-size: larger;">S</span>torage (ORaS)

Initial project to store artifacts in OCI registries

Very low-level

Official guidance for artifacts [](https://github.com/opencontainers/image-spec/blob/main/manifest.md#guidelines-for-artifact-usage)

### Demo

Upload generic artifacts to OCI registry [](https://github.com/nicholasdille/container-slides/blob/master/110_ecosystem/oci/oras.demo)

---

## How it's going

### Existing implementations (excerpt)

Docker App [](https://github.com/docker/app) (archived)

Cloud Native Application Bundles (CNAB) [](https://cnab.io/)
- porter [](https://github.com/getporter/porter)

SBOM for container images [](https://github.com/moby/buildkit/blob/master/docs/attestations/sbom.md)
- BuildKit [](https://github.com/moby/buildkit) >=0.11.0
- buildx [](https://github.com/docker/buildx) >=0.10.0

Container signatures using sigstore's cosign [](https://www.sigstore.dev/)

Helm charts [](https://helm.sh/docs/topics/registries/)

OPA policies [](https://github.com/opcr-io/policy#demo-videosrecordings)
</textarea></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
<!-- 110_ecosystem/oci/slides.md -->
## Generic artifacts in OCI registries

![](110_ecosystem/oci/referrers.drawio.svg) <!-- .element: style="float: right; width: 35%;" -->

OCI 1.1 addresses generic artifacts...

...as well as linking them

OCI 1.1 not released yet [](https://github.com/opencontainers/distribution-spec/releases/tag/v1.1.0-rc.3)

XXX subject

XXX referrers

XXX tree of linked artifacts

### Tooling

XXX https://github.com/oras-project/distribution

XXX tooling: oras, trivy, regclient

---

## Adaption of OCI 1.1

| Registry          | State |
|:------------------|:-----:|
| Distribution      | <i class="fa-duotone fa-square-question"></i> |
| AWS ECR           | <i class="fa-duotone fa-square-question"></i> |
| Azure ACR         | <i class="fa-duotone fa-square-question"></i> |
| Harbor            | <i class="fa-duotone fa-square-question"></i> |
| Jfrog Artifactory | <i class="fa-duotone fa-square-question"></i> |

Legend: <i class="fa-duotone fa-square-question"></i> unknown, <i class="fa-duotone fa-square-exclamation" style="color: yellow"></i> underway, <i class="fa-duotone fa-square-check" style="color: lightgreen;"></i> supported, <i class="fa-duotone fa-square-xmark" style="color: orangered;"></i> unsupported

XXX test?

---

## Workaround / Fallback

XXX [](https://github.com/opencontainers/distribution-spec/blob/v1.1.0-rc.3/spec.md#backwards-compatibility)

XXX subject

XXX tag-sha
</textarea></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
<!-- 110_ecosystem/oci/slides.md -->
## Demo

![](110_ecosystem/oci/referrers-demo.drawio.svg) <!-- .element: style="float: right; width: 35%;" -->

Push image

Sign image, push signature and refer to image

Create SBOM, push it and refer to image

Sign SBOM, push signature and refer to image

Create sarif report, push it and refer to SBOM

Sign sarif report, push signature and refer to sarif report

XXX decide which tool to use: trivy? oras? regctl?
</textarea></section>

<section data-markdown="" data-separator="^---$" data-separator-vertical="^--$"><textarea data-template="">
## Summary

<i class="fa-duotone fa-4x fa-lightbulb-on"></i> <!-- .element: style="float: right;" -->

- <span class="fa-li"><i class="fa-duotone fa-thumbs-up"></i></span> Distribution spec does not prevent generic artifacts
- <span class="fa-li"><i class="fa-duotone fa-rocket"></i></span> ORaS project has initiated efforts
- <span class="fa-li"><i class="fa-duotone fa-person-running-fast"></i></span> Ecosystem is already adopting OCI registries as storage
- <span class="fa-li"><i class="fa-duotone fa-hand-holding-box"></i></span> OCI 1.1 will add support for referrers
- <span class="fa-li"><i class="fa-duotone fa-handshake-simple"></i></span> Client tools already support OCI 1.1

<!-- .element: class="fa-ul" style="line-height: 1.5em;" -->

### Upcoming events

~~2023-11-14: [ContainerConf](https://www.containerconf.de/): Workshop [GitLab CI](https://www.containerconf.de/veranstaltung-20671-0-ci-cd-mit-gitlab.html)~~

~~2023-11-15: [ContainerConf](https://www.containerconf.de/): Talk [OCI 1.1](https://www.containerconf.de/veranstaltung-21037-0-container-registries-als-generische-artefaktspeicher--was-oci-1.1-neues-bringt.html), Talk [Dependency Updates](https://www.containerconf.de/veranstaltung-21033-0-nie-wieder-veraltete-dependencies-wie-sich-sicherheitsluecken-von-selbst-schliessen.html)~~

2023-11-16: [ContainerConf](https://www.containerconf.de/): Talk [Dependency Updates](https://www.containerconf.de/veranstaltung-21033-0-nie-wieder-veraltete-dependencies-wie-sich-sicherheitsluecken-von-selbst-schliessen.html)

2023-11-23: Workshop [GitLab Ops](https://heise-academy.de/schulungen/einfuehrung-in-gitlab) (1 day)

2023-11-30 / 2023-11-07: Workshop [GitLab CI](https://heise-academy.de/schulungen/cicd-gitlab) (2 days)
</textarea></section>

</div>
</div>

<script src="media/reveal.js@4.6.0/dist/reveal.js" type="application/javascript"></script>
<script src="media/reveal.js@4.6.0/plugin/markdown/markdown.js" type="application/javascript"></script>
<script src="media/reveal.js@4.6.0/plugin/highlight/highlight.js" type="application/javascript"></script>
<script src="media/reveal.js@4.6.0/plugin/search/search.js" type="application/javascript"></script>
<script src="media/reveal.js@4.6.0/plugin/zoom/zoom.js" type="application/javascript"></script>
<script src="media/reveal.js@4.6.0/plugin/notes/notes.js" type="application/javascript"></script>
<script>
    var durationInMinutes = 4 * 60;
    Reveal.initialize({
        width: 1300,
        height: 850,
        margin: 0.05,
        controlsTutorial: false,
        showSlideNumber: false,
        hash: true,
        history: true,
        keyboard: true,
        overview: true,
        center: false,
        touch: false,
        shuffle: false,
        fragments: true,
        fragmentInURL: true,
        embedded: false,
        help: true,
        showNotes: false,
        autoPlayMedia: null,
        mouseWheel: false,
        previewLinks: false,
        transition: 'convex',
        transitionSpeed: 'default',
        backgroundTransition: 'fade',
        hideInactiveCursor: true,
        hideCursorTime: 3000,

        totalTime: durationInMinutes * 60,
        allottedTime: durationInMinutes * 60 * 1000,

        barColor: 'rgb(200, 0, 0)',
        pausedBarColor: 'rgba(200, 0, 0, .6)',

        markdown: {
            smartypants: true
        },

        keyboard: {
            // pause/resume time when Enter is pressed
            13: () => {
                ElapsedTimeBar.isPaused ? ElapsedTimeBar.resume() : ElapsedTimeBar.pause();
            },
            // reset timer when 'r' is pressed
            82: () => {
                ElapsedTimeBar.reset();
            }
        },

        dependencies: [
            { src: 'media/plugins/elapsed-time-bar@18feb15/elapsed-time-bar.js' }
        ],

        plugins: [
            RevealMarkdown,
            RevealHighlight,
            RevealSearch,
            RevealZoom,
            RevealNotes
        ]
    });
</script>

</body>
</html>
